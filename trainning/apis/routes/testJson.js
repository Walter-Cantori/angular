const express = require('express')
const router = express.Router()
const _ = require('lodash')

const data = [ 
    { geography: 'NA',
    division: 'o/w Traditional z',
    l_period: '2 YR AVG',
    dtg1: 59.104446,
    dtg2: 27.887382,
    dtg3: 14.379958,
    dtg4: 7.205592,
    dtg5: 7.811936,
    dtg6: 5.136311,
    dtg7: 2.210692,
    dtg8: 0.462107,
    dtg9: 6.307025,
    dtg10: -0.06869,
    dtg11: 3.680708,
    dtg12: 7.197243,
    dtg13: -0.161318,
    dtg14: -0.118715,
    dtg15: -1.854946,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 132.858216002,
    cumulative: 123.736317,
    cq_projection: 256.594533002,
    bdgt: null,
    bw_bdgt: -454.641792998,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'NA',
    division: 'o/w Traditional z',
    l_period: '4 QTR AVG',
    dtg1: 33.702625,
    dtg2: 10.86946,
    dtg3: 14.247235,
    dtg4: 9.266376,
    dtg5: 10.798265,
    dtg6: 25.389883,
    dtg7: 6.584755,
    dtg8: 7.344162,
    dtg9: 0.671263,
    dtg10: 2.715383,
    dtg11: 1.980434,
    dtg12: 2.154834,
    dtg13: 3.418459,
    dtg14: -0.217134,
    dtg15: 1.309208,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 132.858216002,
    cumulative: 110.858599,
    cq_projection: 243.716815002,
    bdgt: null,
    bw_bdgt: -467.519510998,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'NA',
    division: 'Power Systems',
    l_period: '2 YR AVG',
    dtg1: 17.352009,
    dtg2: 9.515213,
    dtg3: 7.418546,
    dtg4: 7.8437090000000005,
    dtg5: 2.588914,
    dtg6: 4.092697,
    dtg7: 1.316548,
    dtg8: 1.171718,
    dtg9: 1.063104,
    dtg10: 0.983127,
    dtg11: 4.809494,
    dtg12: -0.137672,
    dtg13: 2.906137,
    dtg14: 2.444191,
    dtg15: 0.509125,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 119.8104779787,
    cumulative: 50.127636,
    cq_projection: 169.9381139787,
    bdgt: null,
    bw_bdgt: -175.7248330213,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'NA',
    division: 'Power Systems',
    l_period: '4 QTR AVG',
    dtg1: 13.892192,
    dtg2: 7.329954,
    dtg3: 6.008314,
    dtg4: 3.505652,
    dtg5: 3.196077,
    dtg6: 11.821069,
    dtg7: 4.015176,
    dtg8: 1.89087,
    dtg9: 1.69425,
    dtg10: 2.592345,
    dtg11: 2.126484,
    dtg12: -0.03468,
    dtg13: 0.232754,
    dtg14: 1.09097,
    dtg15: -0.544338,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 119.8104779787,
    cumulative: 49.768434,
    cq_projection: 169.5789119787,
    bdgt: null,
    bw_bdgt: -176.0840350213,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'NA',
    division: 'Storage',
    l_period: '2 YR AVG',
    dtg1: 31.317329,
    dtg2: 10.051238,
    dtg3: 5.422628,
    dtg4: 6.437513,
    dtg5: 2.664705,
    dtg6: 4.188674,
    dtg7: 2.111217,
    dtg8: 1.227271,
    dtg9: 3.337845,
    dtg10: -0.236863,
    dtg11: 0.923866,
    dtg12: 0.938091,
    dtg13: 2.194337,
    dtg14: 3.943766,
    dtg15: 2.602384,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 193.9177101016,
    cumulative: 62.193304,
    cq_projection: 256.1110141016,
    bdgt: null,
    bw_bdgt: -185.6518868984,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'NA',
    division: 'Storage',
    l_period: '4 QTR AVG',
    dtg1: 33.307649,
    dtg2: 13.517364,
    dtg3: 10.678851,
    dtg4: 8.159976,
    dtg5: 3.798128,
    dtg6: 11.140804,
    dtg7: 6.02679,
    dtg8: 1.596983,
    dtg9: 2.968992,
    dtg10: 1.993175,
    dtg11: 3.080021,
    dtg12: 2.108739,
    dtg13: 2.024538,
    dtg14: 2.335669,
    dtg15: 1.6483370000000002,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 193.9177101016,
    cumulative: 86.62956199999999,
    cq_projection: 280.5472721016,
    bdgt: null,
    bw_bdgt: -161.2156288984,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'EUROPE',
    division: 'o/w Traditional z',
    l_period: '2 YR AVG',
    dtg1: 16.297149,
    dtg2: 3.09099,
    dtg3: 0.049875,
    dtg4: 0.949453,
    dtg5: 0.038428,
    dtg6: 0.834956,
    dtg7: 0.082269,
    dtg8: 0.371067,
    dtg9: 0.68955,
    dtg10: 1.57345,
    dtg11: 0.518498,
    dtg12: 2.61733,
    dtg13: 0.733999,
    dtg14: -0.726737,
    dtg15: 0.636975,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 61.178929334,
    cumulative: 21.34312,
    cq_projection: 82.522049334,
    bdgt: null,
    bw_bdgt: -254.396046666,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'EUROPE',
    division: 'o/w Traditional z',
    l_period: '4 QTR AVG',
    dtg1: 19.787732,
    dtg2: 9.139178,
    dtg3: 1.772393,
    dtg4: 1.626428,
    dtg5: -0.038966,
    dtg6: 3.0228,
    dtg7: 5.681844,
    dtg8: 1.48542,
    dtg9: 0.74788,
    dtg10: 0.166872,
    dtg11: 2.294605,
    dtg12: 0.274995,
    dtg13: 0.238413,
    dtg14: 0.940335,
    dtg15: 2.103594,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 61.178929334,
    cumulative: 40.991409,
    cq_projection: 102.170338334,
    bdgt: null,
    bw_bdgt: -234.747757666,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'EUROPE',
    division: 'Power Systems',
    l_period: '2 YR AVG',
    dtg1: 9.364273,
    dtg2: 4.115229,
    dtg3: 2.9151350000000003,
    dtg4: 2.965496,
    dtg5: 1.543744,
    dtg6: 1.9018890000000002,
    dtg7: 0.893605,
    dtg8: 1.26004,
    dtg9: 1.504903,
    dtg10: 0.806851,
    dtg11: 0.365036,
    dtg12: 0.142323,
    dtg13: 0.494183,
    dtg14: 0.068869,
    dtg15: 0.545908,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 71.4297712956,
    cumulative: 23.699371,
    cq_projection: 95.1291422956,
    bdgt: null,
    bw_bdgt: -88.3847057044,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'EUROPE',
    division: 'Power Systems',
    l_period: '4 QTR AVG',
    dtg1: 11.154834,
    dtg2: 6.107463,
    dtg3: 2.590586,
    dtg4: 1.712202,
    dtg5: 0.868975,
    dtg6: 4.981489,
    dtg7: 1.9746899999999998,
    dtg8: 0.69681,
    dtg9: 1.856049,
    dtg10: 0.837769,
    dtg11: 2.330964,
    dtg12: 0.37666,
    dtg13: 1.288627,
    dtg14: 1.000519,
    dtg15: 1.077333,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 71.4297712956,
    cumulative: 29.390239,
    cq_projection: 100.8200102956,
    bdgt: null,
    bw_bdgt: -82.6938377044,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'EUROPE',
    division: 'Storage',
    l_period: '2 YR AVG',
    dtg1: 11.999907,
    dtg2: 5.855307,
    dtg3: 2.278553,
    dtg4: 8.041864,
    dtg5: 1.799245,
    dtg6: 2.902953,
    dtg7: 0.916017,
    dtg8: 0.540879,
    dtg9: 1.771854,
    dtg10: 1.458941,
    dtg11: 1.472416,
    dtg12: 0.396171,
    dtg13: 1.517706,
    dtg14: 1.19342,
    dtg15: -0.136908,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 167.6864036998,
    cumulative: 33.793846,
    cq_projection: 201.4802496998,
    bdgt: null,
    bw_bdgt: -114.5339133002,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'EUROPE',
    division: 'Storage',
    l_period: '4 QTR AVG',
    dtg1: 18.33393,
    dtg2: 9.694227,
    dtg3: 4.984258,
    dtg4: 3.081484,
    dtg5: 1.850211,
    dtg6: 8.71471,
    dtg7: 2.411793,
    dtg8: 2.142066,
    dtg9: 2.808067,
    dtg10: 1.252504,
    dtg11: 4.649122,
    dtg12: 1.600595,
    dtg13: 1.7182819999999999,
    dtg14: 0.840931,
    dtg15: 1.06395,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 167.6864036998,
    cumulative: 49.070613,
    cq_projection: 216.7570166998,
    bdgt: null,
    bw_bdgt: -99.2571463002,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'JAPAN',
    division: 'o/w Traditional z',
    l_period: '2 YR AVG',
    dtg1: 0.696423,
    dtg2: 0.600183,
    dtg3: 0.715529,
    dtg4: -0.012597,
    dtg5: 0.475,
    dtg6: 0,
    dtg7: 0,
    dtg8: 0,
    dtg9: 0.615,
    dtg10: 0,
    dtg11: 0.305,
    dtg12: 0.011429,
    dtg13: 0,
    dtg14: 0.132045,
    dtg15: 0,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 13.342714285,
    cumulative: 2.474538,
    cq_projection: 15.817252285,
    bdgt: null,
    bw_bdgt: -56.424223715,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'JAPAN',
    division: 'o/w Traditional z',
    l_period: '4 QTR AVG',
    dtg1: 0.402721,
    dtg2: 6.203091,
    dtg3: 3.754737,
    dtg4: 0.174226,
    dtg5: 0.587505,
    dtg6: 0,
    dtg7: 0.084261,
    dtg8: 0.011286,
    dtg9: 0,
    dtg10: 0.075,
    dtg11: 0.667172,
    dtg12: -0.076786,
    dtg13: 0.05,
    dtg14: 0,
    dtg15: 0.1,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 13.342714285,
    cumulative: 11.206541,
    cq_projection: 24.549255285,
    bdgt: null,
    bw_bdgt: -47.692220715,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'JAPAN',
    division: 'Power Systems',
    l_period: '2 YR AVG',
    dtg1: 1.675577,
    dtg2: 1.1042939999999999,
    dtg3: 0.501652,
    dtg4: 0.587175,
    dtg5: 0.124621,
    dtg6: 0.101501,
    dtg7: 0,
    dtg8: 0.360446,
    dtg9: 0.406908,
    dtg10: 0.031553,
    dtg11: 0.477376,
    dtg12: 0.177147,
    dtg13: 0.157903,
    dtg14: -0.075967,
    dtg15: 0.378181,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 20.5929537005,
    cumulative: 4.09482,
    cq_projection: 24.6877737005,
    bdgt: null,
    bw_bdgt: -14.3817472995,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'JAPAN',
    division: 'Power Systems',
    l_period: '4 QTR AVG',
    dtg1: 0.414368,
    dtg2: 0.678362,
    dtg3: 2.107997,
    dtg4: 0.989017,
    dtg5: 0.377135,
    dtg6: 0.46168,
    dtg7: 0.221421,
    dtg8: 0.383606,
    dtg9: 0.693255,
    dtg10: 0.131998,
    dtg11: 0.935143,
    dtg12: 0.467505,
    dtg13: 0.12559,
    dtg14: 0.15071,
    dtg15: 0.175923,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 20.5929537005,
    cumulative: 5.24998,
    cq_projection: 25.8429337005,
    bdgt: null,
    bw_bdgt: -13.2265872995,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'JAPAN',
    division: 'Storage',
    l_period: '2 YR AVG',
    dtg1: 1.2555589999999999,
    dtg2: 1.671489,
    dtg3: 0.475698,
    dtg4: 0.404129,
    dtg5: 0.828976,
    dtg6: 0.894362,
    dtg7: 0,
    dtg8: 0.244946,
    dtg9: 1.346158,
    dtg10: 0.059494,
    dtg11: 0.228329,
    dtg12: 0.278702,
    dtg13: 0.361631,
    dtg14: -0.085622,
    dtg15: 0.292508,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 16.0883641707,
    cumulative: 5.530213,
    cq_projection: 21.6185771707,
    bdgt: null,
    bw_bdgt: -41.2166238293,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'JAPAN',
    division: 'Storage',
    l_period: '4 QTR AVG',
    dtg1: 0.184461,
    dtg2: 2.048771,
    dtg3: 1.481209,
    dtg4: 1.244943,
    dtg5: 1.169007,
    dtg6: 1.0321,
    dtg7: 0.337192,
    dtg8: 0.42631,
    dtg9: 0.72008,
    dtg10: 0.052556,
    dtg11: 0.984963,
    dtg12: 0.921586,
    dtg13: 2.123058,
    dtg14: 0.44432,
    dtg15: 2.734678,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 16.0883641707,
    cumulative: 7.497683,
    cq_projection: 23.5860471707,
    bdgt: null,
    bw_bdgt: -39.2491538293,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'AP',
    division: 'o/w Traditional z',
    l_period: '2 YR AVG',
    dtg1: 2.399,
    dtg2: -0.05,
    dtg3: -0.395,
    dtg4: 0.395,
    dtg5: 0,
    dtg6: 0,
    dtg7: 0,
    dtg8: 0,
    dtg9: 0.077887,
    dtg10: 0,
    dtg11: 0,
    dtg12: 0.013161,
    dtg13: 0,
    dtg14: 0.008748,
    dtg15: 0.210001,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 10.497696992,
    cumulative: 2.349,
    cq_projection: 12.846696992,
    bdgt: null,
    bw_bdgt: -28.305480008,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'AP',
    division: 'o/w Traditional z',
    l_period: '4 QTR AVG',
    dtg1: 3.458368,
    dtg2: 3.102944,
    dtg3: 0.35675,
    dtg4: 1.4494,
    dtg5: 0.051597,
    dtg6: 0.159588,
    dtg7: 0.122022,
    dtg8: 0.003875,
    dtg9: 1.117575,
    dtg10: 0,
    dtg11: 0.074761,
    dtg12: 0.076959,
    dtg13: -0.048846,
    dtg14: 0.085582,
    dtg15: 0,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 10.497696992,
    cumulative: 8.700669,
    cq_projection: 19.198365992,
    bdgt: null,
    bw_bdgt: -21.953811008,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'AP',
    division: 'Power Systems',
    l_period: '2 YR AVG',
    dtg1: 15.908165,
    dtg2: 1.52398,
    dtg3: 0.661123,
    dtg4: 5.179351,
    dtg5: 5.097049,
    dtg6: 1.667493,
    dtg7: 0.758992,
    dtg8: 0.191359,
    dtg9: 0.964461,
    dtg10: 0.564999,
    dtg11: 0.784892,
    dtg12: 0.395995,
    dtg13: 0.149718,
    dtg14: 0.904511,
    dtg15: 0.052796,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 22.7840704184,
    cumulative: 30.796153,
    cq_projection: 53.5802234184,
    bdgt: null,
    bw_bdgt: -27.2608645816,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'AP',
    division: 'Power Systems',
    l_period: '4 QTR AVG',
    dtg1: 10.597131,
    dtg2: 2.193996,
    dtg3: 2.751655,
    dtg4: 1.382167,
    dtg5: 0.310339,
    dtg6: 2.8844,
    dtg7: 1.588533,
    dtg8: 1.764869,
    dtg9: 0.465659,
    dtg10: 0.083071,
    dtg11: 1.607713,
    dtg12: 0.723244,
    dtg13: 0.418858,
    dtg14: 0.024422,
    dtg15: 0.134116,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 22.7840704184,
    cumulative: 21.708221,
    cq_projection: 44.4922914184,
    bdgt: null,
    bw_bdgt: -36.3487965816,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'AP',
    division: 'Storage',
    l_period: '2 YR AVG',
    dtg1: 8.815401,
    dtg2: 0.832626,
    dtg3: 0.895128,
    dtg4: 2.039851,
    dtg5: 0.586672,
    dtg6: 1.2292399999999999,
    dtg7: 0.136515,
    dtg8: 0.143421,
    dtg9: 1.180079,
    dtg10: 0.059851,
    dtg11: 0.742096,
    dtg12: 0.314743,
    dtg13: 0.084917,
    dtg14: 0.604792,
    dtg15: 0.297629,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 21.2249461696,
    cumulative: 14.535433,
    cq_projection: 35.7603791696,
    bdgt: null,
    bw_bdgt: -44.8334718304,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'AP',
    division: 'Storage',
    l_period: '4 QTR AVG',
    dtg1: 11.645195,
    dtg2: 2.626782,
    dtg3: 1.735125,
    dtg4: 0.742967,
    dtg5: 0.47388,
    dtg6: 2.347413,
    dtg7: 0.349219,
    dtg8: 0.385592,
    dtg9: 0.56123,
    dtg10: 0.253214,
    dtg11: 1.089594,
    dtg12: 0.225122,
    dtg13: 0.316886,
    dtg14: 0.462967,
    dtg15: 0.190845,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 21.2249461696,
    cumulative: 19.920581,
    cq_projection: 41.1455271696,
    bdgt: null,
    bw_bdgt: -39.4483238304,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'GCG',
    division: 'o/w Traditional z',
    l_period: '2 YR AVG',
    dtg1: 1.58375,
    dtg2: 0.068601,
    dtg3: -0.065,
    dtg4: 1.34,
    dtg5: 0,
    dtg6: 0,
    dtg7: 0,
    dtg8: 0,
    dtg9: 0,
    dtg10: 0,
    dtg11: 0,
    dtg12: 0,
    dtg13: 0,
    dtg14: 0.001801,
    dtg15: 0,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 8.021139,
    cumulative: 2.927351,
    cq_projection: 10.94849,
    bdgt: null,
    bw_bdgt: -178.556471,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'GCG',
    division: 'o/w Traditional z',
    l_period: '4 QTR AVG',
    dtg1: 3.254451,
    dtg2: 11.904611,
    dtg3: 1.761179,
    dtg4: 2.401321,
    dtg5: 45.324999,
    dtg6: 0.15249,
    dtg7: -0.09675,
    dtg8: 0.05,
    dtg9: 0,
    dtg10: 1.025,
    dtg11: 0,
    dtg12: 0,
    dtg13: 0,
    dtg14: 0,
    dtg15: 0,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 8.021139,
    cumulative: 64.702301,
    cq_projection: 72.72344,
    bdgt: null,
    bw_bdgt: -116.781521,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'GCG',
    division: 'Power Systems',
    l_period: '2 YR AVG',
    dtg1: 14.641117,
    dtg2: 11.660254,
    dtg3: 4.503271,
    dtg4: 3.557725,
    dtg5: 2.500429,
    dtg6: 1.5439720000000001,
    dtg7: 0.202636,
    dtg8: 0.259029,
    dtg9: 0.743231,
    dtg10: -0.003896,
    dtg11: 0.521426,
    dtg12: 0.384641,
    dtg13: 0.576237,
    dtg14: 0.616623,
    dtg15: 0.080837,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 14.0385210527,
    cumulative: 38.609404,
    cq_projection: 52.6479250527,
    bdgt: null,
    bw_bdgt: -45.8848029473,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'GCG',
    division: 'Power Systems',
    l_period: '4 QTR AVG',
    dtg1: 14.000834,
    dtg2: 6.98246,
    dtg3: 6.161739,
    dtg4: 2.024065,
    dtg5: 1.124506,
    dtg6: 1.956419,
    dtg7: 0.358558,
    dtg8: 0.671734,
    dtg9: 0.140694,
    dtg10: 0.088945,
    dtg11: 0.907086,
    dtg12: 0.144447,
    dtg13: 1.110806,
    dtg14: 0.313659,
    dtg15: 0.202209,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 14.0385210527,
    cumulative: 32.608581,
    cq_projection: 46.6471020527,
    bdgt: null,
    bw_bdgt: -51.8856259473,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'GCG',
    division: 'Storage',
    l_period: '2 YR AVG',
    dtg1: 6.836241,
    dtg2: 3.5752639999999998,
    dtg3: 0.950561,
    dtg4: 1.870741,
    dtg5: 0.178042,
    dtg6: 0.709279,
    dtg7: 0.063939,
    dtg8: 0.5241,
    dtg9: 0.235763,
    dtg10: 0.906913,
    dtg11: -0.141766,
    dtg12: 0.0126,
    dtg13: 0.87943,
    dtg14: -0.283859,
    dtg15: 0.118502,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 12.9885633426,
    cumulative: 14.184067,
    cq_projection: 27.1726303426,
    bdgt: null,
    bw_bdgt: -54.8102496574,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'GCG',
    division: 'Storage',
    l_period: '4 QTR AVG',
    dtg1: 8.486516,
    dtg2: 3.151474,
    dtg3: 1.34954,
    dtg4: 4.487982,
    dtg5: 1.756367,
    dtg6: 0.627988,
    dtg7: 0.435214,
    dtg8: 0.31796,
    dtg9: 0.323442,
    dtg10: 0.36961,
    dtg11: 0.135348,
    dtg12: 0.364334,
    dtg13: 0.173797,
    dtg14: 0.114143,
    dtg15: 0.081172,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 12.9885633426,
    cumulative: 20.295081,
    cq_projection: 33.2836443426,
    bdgt: null,
    bw_bdgt: -48.6992356574,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'LA',
    division: 'o/w Traditional z',
    l_period: '2 YR AVG',
    dtg1: 23.750252,
    dtg2: -0.007582,
    dtg3: 0,
    dtg4: 0.00065,
    dtg5: 0,
    dtg6: -0.007582,
    dtg7: 0,
    dtg8: 0,
    dtg9: 0,
    dtg10: 0,
    dtg11: 0,
    dtg12: 0.607154,
    dtg13: 0,
    dtg14: -0.010463,
    dtg15: 0.136157,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 16.02625549,
    cumulative: 23.735738,
    cq_projection: 39.76199349,
    bdgt: null,
    bw_bdgt: -71.35193451,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'LA',
    division: 'o/w Traditional z',
    l_period: '4 QTR AVG',
    dtg1: 24.268423,
    dtg2: 1.72129,
    dtg3: 2.711894,
    dtg4: 0.592877,
    dtg5: 0.314814,
    dtg6: 0.437416,
    dtg7: -0.015537,
    dtg8: 0,
    dtg9: 0,
    dtg10: 0.187202,
    dtg11: 0.117433,
    dtg12: -0.010572,
    dtg13: 0,
    dtg14: 0,
    dtg15: 0.068078,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 16.02625549,
    cumulative: 30.031177,
    cq_projection: 46.05743249,
    bdgt: null,
    bw_bdgt: -65.05649551,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'LA',
    division: 'Power Systems',
    l_period: '2 YR AVG',
    dtg1: 0.719117,
    dtg2: 2.40387,
    dtg3: 0.460978,
    dtg4: 0.85351,
    dtg5: 0.823363,
    dtg6: 0.073603,
    dtg7: 0.027012,
    dtg8: 0.363525,
    dtg9: 1.176209,
    dtg10: 0.026658,
    dtg11: 0.011316,
    dtg12: 0.467852,
    dtg13: -0.245733,
    dtg14: 1.193053,
    dtg15: -0.027267,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 8.6504860743,
    cumulative: 5.361453,
    cq_projection: 14.0119390743,
    bdgt: null,
    bw_bdgt: -20.8829319257,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'LA',
    division: 'Power Systems',
    l_period: '4 QTR AVG',
    dtg1: 2.502097,
    dtg2: 1.9825080000000002,
    dtg3: 0.458204,
    dtg4: 0.477766,
    dtg5: -0.147003,
    dtg6: 0.708931,
    dtg7: -0.170841,
    dtg8: 0.164745,
    dtg9: 0.910789,
    dtg10: 0.496918,
    dtg11: 0.677313,
    dtg12: -0.068772,
    dtg13: 0.156783,
    dtg14: -0.13651,
    dtg15: 0.445062,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 8.6504860743,
    cumulative: 5.811662,
    cq_projection: 14.4621480743,
    bdgt: null,
    bw_bdgt: -20.4327229257,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'LA',
    division: 'Storage',
    l_period: '2 YR AVG',
    dtg1: 8.510612,
    dtg2: 1.8285559999999998,
    dtg3: 0.017759,
    dtg4: 2.893925,
    dtg5: 0.853866,
    dtg6: 0.353167,
    dtg7: 0.209192,
    dtg8: -0.354119,
    dtg9: 1.6906539999999999,
    dtg10: 0.492761,
    dtg11: 0.417827,
    dtg12: 0.259773,
    dtg13: 0.057605,
    dtg14: 0.792545,
    dtg15: -0.15105,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 19.730539142,
    cumulative: 14.667077,
    cq_projection: 34.397616142,
    bdgt: null,
    bw_bdgt: -25.411156858,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'LA',
    division: 'Storage',
    l_period: '4 QTR AVG',
    dtg1: 4.344858,
    dtg2: 0.888249,
    dtg3: 4.468257,
    dtg4: 0.406614,
    dtg5: 0.140258,
    dtg6: 0.965252,
    dtg7: -0.096111,
    dtg8: -0.134362,
    dtg9: 0.873571,
    dtg10: 0.195174,
    dtg11: 0.919535,
    dtg12: 0.125566,
    dtg13: 0.168186,
    dtg14: 0.690618,
    dtg15: 0.184487,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 19.730539142,
    cumulative: 11.117377,
    cq_projection: 30.847916142,
    bdgt: null,
    bw_bdgt: -28.960856858,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'MEA',
    division: 'o/w Traditional z',
    l_period: '2 YR AVG',
    dtg1: 0.81612,
    dtg2: 0,
    dtg3: 0.210882,
    dtg4: 0,
    dtg5: 0,
    dtg6: 0,
    dtg7: 0,
    dtg8: 0,
    dtg9: 0.034157,
    dtg10: 0.438995,
    dtg11: 0,
    dtg12: 0.281358,
    dtg13: 0.058992,
    dtg14: 0.019448,
    dtg15: 0,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 12.28100702,
    cumulative: 1.027002,
    cq_projection: 13.30800902,
    bdgt: null,
    bw_bdgt: -22.11335098,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'MEA',
    division: 'o/w Traditional z',
    l_period: '4 QTR AVG',
    dtg1: 1.284716,
    dtg2: 0.58537,
    dtg3: 0.128,
    dtg4: 0,
    dtg5: 0,
    dtg6: 0,
    dtg7: 0.8245,
    dtg8: 0.032738,
    dtg9: 0.000828,
    dtg10: 0.004123,
    dtg11: 0.003902,
    dtg12: 0.147759,
    dtg13: 0,
    dtg14: 0.016781,
    dtg15: 0,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 12.28100702,
    cumulative: 2.8225860000000003,
    cq_projection: 15.10359302,
    bdgt: null,
    bw_bdgt: -20.31776698,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'MEA',
    division: 'Power Systems',
    l_period: '2 YR AVG',
    dtg1: 1.468848,
    dtg2: 1.691811,
    dtg3: 0.691363,
    dtg4: 0.140856,
    dtg5: 0.23472,
    dtg6: 0.321901,
    dtg7: 0.039116,
    dtg8: 0.369111,
    dtg9: 0.646311,
    dtg10: 0.358154,
    dtg11: -0.076577,
    dtg12: 0.131133,
    dtg13: 0.051632,
    dtg14: 0.062044,
    dtg15: 0.035169,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 11.867398031,
    cumulative: 4.588615,
    cq_projection: 16.456013031,
    bdgt: null,
    bw_bdgt: -18.140202969,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'MEA',
    division: 'Power Systems',
    l_period: '4 QTR AVG',
    dtg1: 2.6275269999999997,
    dtg2: 1.815887,
    dtg3: 0.860739,
    dtg4: 0.584906,
    dtg5: 0.270914,
    dtg6: 0.446554,
    dtg7: 0.356249,
    dtg8: 0.100731,
    dtg9: 0.13157,
    dtg10: 0.082444,
    dtg11: 0.027371,
    dtg12: 0.162663,
    dtg13: 0.231609,
    dtg14: 0.152678,
    dtg15: 0.047973,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 11.867398031,
    cumulative: 6.962776,
    cq_projection: 18.830174031,
    bdgt: null,
    bw_bdgt: -15.766041969,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'MEA',
    division: 'Storage',
    l_period: '2 YR AVG',
    dtg1: 1.962768,
    dtg2: 0.558028,
    dtg3: 0.249315,
    dtg4: 0.78214,
    dtg5: 0.100855,
    dtg6: 0.397417,
    dtg7: 0.523921,
    dtg8: 0.548199,
    dtg9: 0.065587,
    dtg10: 0.230636,
    dtg11: -0.667802,
    dtg12: 0.776722,
    dtg13: -0.047861,
    dtg14: -0.019244,
    dtg15: 0.406195,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 12.8587892882,
    cumulative: 4.574444,
    cq_projection: 17.4332332882,
    bdgt: null,
    bw_bdgt: -20.6402797118,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' },
    { geography: 'MEA',
    division: 'Storage',
    l_period: '4 QTR AVG',
    dtg1: 2.417356,
    dtg2: 0.796415,
    dtg3: 1.571996,
    dtg4: 0.3173,
    dtg5: -0.167631,
    dtg6: 1.396994,
    dtg7: 0.456139,
    dtg8: 0.856209,
    dtg9: 0.213602,
    dtg10: 0.100704,
    dtg11: -0.13459,
    dtg12: 0.580331,
    dtg13: -0.057095,
    dtg14: 0.193563,
    dtg15: 0.087364,
    week_in_qtr: 3,
    day_of_week: 5,
    insert_date: '2017-10-23',
    firm_stream: 12.8587892882,
    cumulative: 6.788569,
    cq_projection: 19.6473582882,
    bdgt: null,
    bw_bdgt: -18.4261547118,
    crnt_qtr: '4Q17',
    dtg_current: 7,
    day_rfd: 20,
    month_rfd: 10,
    quarter_rfd: '4Q' } 
]


router.get('/', (req, res) => {

    const oldResult = _.chain(data)
                        .groupBy((v,k) => v['geography'])
                        .value()


    let geoGroup = {}
    for(let i = 0; i < data.length; i++){
        if( !geoGroup.hasOwnProperty(data[i].geography) ){
            geoGroup[data[i].geography] = {rows: [ data[i] ]}
        }else{
            geoGroup[data[i].geography].rows.push(data[i])
        }
    }
  
    
    let objCount = 0 
    let divGroup = []
    let result = []

    for(let geo in geoGroup){
        divGroup.push({})
        result.push({})
    
        for(let x = 0; x < geoGroup[geo].rows.length; x++){
                if(!divGroup[objCount].hasOwnProperty(geoGroup[geo].rows[x].division) ){
                    //divGroup[objCount]["geography"] = geo
                    result[objCount].geography = geo
                    
                    divGroup[objCount][geoGroup[geo].rows[x].division] = {rows: [ geoGroup[geo].rows[x] ]}
                } else {
                    divGroup[objCount][geoGroup[geo].rows[x].division].rows.push(geoGroup[geo].rows[x] )
                }
                
        }
        
        result[objCount].divisions = []
        for(let j = 0; j < Object.keys(divGroup[objCount]).length; j++){
             result[objCount].divisions.push(
                 {'division': Object.keys(divGroup[objCount])[j],
                 'rows':  divGroup[objCount][Object.keys(divGroup[objCount])[j]].rows
             })
        }


        objCount++
    }
     
    


    res.send( result)
})

module.exports = router


//response[Object.keys(response)[0]][divisions][0][rows]["crnt_qtr"]
//response[Object.keys(response)[0]][0]["crnt_qtr"]

//response[Object.keys(response)[0]]['divisions'][0]['rows'][0]["l_period"]
//result[Object.keys(result)[0]]['divisions'][0]['rows'][0]["crnt_qtr"]

//result[Object.keys(result)[0]]['divisions'][0]['rows'][0]["dtg_current"]
